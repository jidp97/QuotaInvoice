@inject HttpClient Http
@inject IJSRuntime JS
@inject NavigationManager NavigationManager
@inject IMethods methods
@attribute [Authorize]

<ModalDisplay>
    <Content>
        <MetroCardForm TextBoton="Guardar cambios" OnValidSubmit="@ModifyMetroCard" MetroCard="MetroCard" />
    </Content>
</ModalDisplay>

@code {
    [Parameter] public string Id { get; set; }
    [CascadingParameter] MudDialogInstance MudDialog { get; set; }
    [Parameter] public MetroCard MetroCard { get; set; }
    private const string HubName = "ProcesosHub";

    private async Task ModifyMetroCard()
    {
        await methods.ConnectToHub(HubName);
        await Http.PutAsJsonAsync("api/metrocard", MetroCard);
        await methods.SendMessageToHub(HubMessagesType.Modificado, HubName);
        MudDialog.Close(DialogResult.Ok(true));
    }
}
